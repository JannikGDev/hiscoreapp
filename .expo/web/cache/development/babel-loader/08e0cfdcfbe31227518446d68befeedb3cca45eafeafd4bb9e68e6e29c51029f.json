{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport MessageBox from \"../shared/MessageBox\";\nimport { BarCodeScanner } from 'expo-barcode-scanner';\nimport styles from \"../styles/defaultStyle\";\nimport { ScanCode } from \"../shared/CompanionAPI.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport var QRScannerScreen = function QRScannerScreen(_ref) {\n  var navigation = _ref.navigation,\n    route = _ref.route;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    hasPermission = _useState2[0],\n    setHasPermission = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    scanned = _useState4[0],\n    setScanned = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    showMessage = _useState6[0],\n    setShowMessage = _useState6[1];\n  var _useState7 = useState(\"\"),\n    _useState8 = _slicedToArray(_useState7, 2),\n    message = _useState8[0],\n    setMessage = _useState8[1];\n  useEffect(function () {\n    var getBarCodeScannerPermissions = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        var _yield$BarCodeScanner = yield BarCodeScanner.requestPermissionsAsync(),\n          status = _yield$BarCodeScanner.status;\n        setHasPermission(status === 'granted');\n      });\n      return function getBarCodeScannerPermissions() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    getBarCodeScannerPermissions();\n  }, []);\n  var handleBarCodeScanned = function () {\n    var _ref4 = _asyncToGenerator(function* (_ref3) {\n      var type = _ref3.type,\n        data = _ref3.data;\n      setScanned(true);\n      var result = yield ScanCode(data);\n      console.log(result);\n      if (result.statusCode == 401) {\n        setMessage(\"Der Code wurde bereits verwendet und ist nicht mehr g\\xFCltig.\");\n        setShowMessage(true);\n        return;\n      }\n      if (result.statusCode == 404) {\n        setMessage(\"Der QR Code ist kein g\\xFCltiger HI-SCORE Code.\");\n        setShowMessage(true);\n        return;\n      }\n      if (result.statusCode == 409) {\n        setMessage(\"Der Quest dieses QR Codes ist nicht aktiv.\");\n        setShowMessage(true);\n        return;\n      }\n      if (result.statusCode == 400) {\n        setMessage(\"Du kannst diese Quest nicht nochmal absolvieren.\");\n        setShowMessage(true);\n        return;\n      }\n      setMessage(\"Du hast die Quest \" + result.response.name + \" absolviert! Du hast \" + result.response.experience + \" EXP bekommen!\");\n      setShowMessage(true);\n    });\n    return function handleBarCodeScanned(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  if (hasPermission === null || hasPermission === false) {\n    return _jsxs(View, {\n      style: styles.pageContainer,\n      children: [_jsx(Text, {\n        style: styles.pageTitle,\n        children: \"QR Code Scanner\"\n      }), _jsx(Pressable, {\n        onPress: _asyncToGenerator(function* () {\n          var _yield$BarCodeScanner2 = yield BarCodeScanner.requestPermissionsAsync(),\n            status = _yield$BarCodeScanner2.status;\n          setHasPermission(status === 'granted');\n        }),\n        children: _jsx(Text, {\n          style: [styles.text, {\n            flex: 1,\n            textAlignVertical: 'center'\n          }],\n          children: \"Berechtigung zur Nutzung der Kamera freigeben\"\n        })\n      })]\n    });\n  }\n  return _jsxs(View, {\n    style: styles.pageContainer,\n    children: [_jsx(Text, {\n      style: styles.pageTitle,\n      children: \"QR Code Scanner\"\n    }), _jsx(MessageBox, {\n      text: message,\n      show: showMessage,\n      onClose: function onClose() {\n        setShowMessage(false);\n        navigation.goBack();\n      }\n    }), _jsx(BarCodeScanner, {\n      onBarCodeScanned: scanned ? undefined : handleBarCodeScanned,\n      style: [StyleSheet.absoluteFillObject, {\n        marginTop: 64\n      }]\n    }), scanned && _jsx(Button, {\n      title: 'Tippen um nochmal zu scannen',\n      onPress: function onPress() {\n        return setScanned(false);\n      }\n    })]\n  });\n};","map":{"version":3,"names":["React","useState","useEffect","Text","View","StyleSheet","Button","Pressable","MessageBox","BarCodeScanner","styles","ScanCode","jsx","_jsx","jsxs","_jsxs","QRScannerScreen","_ref","navigation","route","_useState","_useState2","_slicedToArray","hasPermission","setHasPermission","_useState3","_useState4","scanned","setScanned","_useState5","_useState6","showMessage","setShowMessage","_useState7","_useState8","message","setMessage","getBarCodeScannerPermissions","_ref2","_asyncToGenerator","_yield$BarCodeScanner","requestPermissionsAsync","status","apply","arguments","handleBarCodeScanned","_ref4","_ref3","type","data","result","console","log","statusCode","response","name","experience","_x","style","pageContainer","children","pageTitle","onPress","_yield$BarCodeScanner2","text","flex","textAlignVertical","show","onClose","goBack","onBarCodeScanned","undefined","absoluteFillObject","marginTop","title"],"sources":["C:/Workspace/Programming/Mobile/hiscoreapp/HI-SCORE/screens/QRScannerScreen.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Text, View, StyleSheet, Button, Pressable } from 'react-native';\r\nimport MessageBox from '../shared/MessageBox'\r\nimport { BarCodeScanner } from 'expo-barcode-scanner';\r\nimport styles from '../styles/defaultStyle';\r\nimport {ScanCode} from '../shared/CompanionAPI.js'\r\n\r\n\r\nexport const QRScannerScreen = ({navigation, route}) => {\r\n  const [hasPermission, setHasPermission] = useState(null);\r\n  const [scanned, setScanned] = useState(false);\r\n  const [showMessage, setShowMessage] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    const getBarCodeScannerPermissions = async () => {\r\n      const { status } = await BarCodeScanner.requestPermissionsAsync();\r\n      setHasPermission(status === 'granted');\r\n    };\r\n\r\n    getBarCodeScannerPermissions();\r\n  }, []);\r\n\r\n  const handleBarCodeScanned = async ({ type, data }) => {\r\n    setScanned(true);\r\n\r\n    let result = await ScanCode(data);\r\n\r\n    console.log(result);\r\n\r\n    if(result.statusCode == 401) {\r\n      setMessage(`Der Code wurde bereits verwendet und ist nicht mehr gültig.`);\r\n      setShowMessage(true);\r\n      return;\r\n    }\r\n    if(result.statusCode == 404) {\r\n      setMessage(`Der QR Code ist kein gültiger HI-SCORE Code.`);\r\n      setShowMessage(true);\r\n      return;\r\n    }\r\n    if(result.statusCode == 409) {\r\n      setMessage(`Der Quest dieses QR Codes ist nicht aktiv.`);\r\n      setShowMessage(true);\r\n      return;\r\n    }\r\n    if(result.statusCode == 400) {\r\n      setMessage(`Du kannst diese Quest nicht nochmal absolvieren.`);\r\n      setShowMessage(true);\r\n      return;\r\n    }\r\n\r\n    setMessage(`Du hast die Quest ${result.response.name} absolviert! Du hast ${result.response.experience} EXP bekommen!`);\r\n    setShowMessage(true);\r\n  };\r\n\r\n  if (hasPermission === null || hasPermission === false) {\r\n    return <View style={styles.pageContainer}>\r\n      <Text style={styles.pageTitle}>QR Code Scanner</Text>\r\n      <Pressable onPress={async () => {\r\n        const { status } = await BarCodeScanner.requestPermissionsAsync();\r\n        setHasPermission(status === 'granted');\r\n      }}>\r\n      <Text style={[styles.text,{flex: 1, textAlignVertical: 'center'}]}>\r\n        Berechtigung zur Nutzung der Kamera freigeben\r\n      </Text>\r\n      </Pressable>\r\n      </View>;\r\n  }\r\n\r\n  return (\r\n    <View style={styles.pageContainer}>\r\n      <Text style={styles.pageTitle}>QR Code Scanner</Text>\r\n      \r\n      <MessageBox \r\n            text={message}\r\n            show={showMessage}\r\n            onClose={() => {\r\n                setShowMessage(false);\r\n                navigation.goBack();\r\n            }}\r\n        />\r\n      <BarCodeScanner\r\n        onBarCodeScanned={scanned ? undefined : handleBarCodeScanned}\r\n        style={[StyleSheet.absoluteFillObject, {marginTop: 64}]}\r\n      />\r\n      {scanned && <Button title={'Tippen um nochmal zu scannen'} onPress={() => setScanned(false)} />}\r\n    </View>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}